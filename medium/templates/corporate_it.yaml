# Corporate IT Template
# Generic corporate server environment

metadata:
  name: "Corporate IT"
  description: "Simulates a standard corporate IT production server"
  category: "corporate"
  version: "1.0"
  author: "HoneyMesh"

configuration:
  hostname: "app-server-prd01.corporate.local"
  ssh_banner: "SSH-2.0-OpenSSH_8.4p1 Ubuntu-5ubuntu1.3"
  timezone: "US/Eastern"

users:
  webadmin:
    password: "Web2024!"
    uid: 1001
    gid: 1001
    home: "/home/webadmin"
    shell: "/bin/bash"
    gecos: "Web Administrator"
  
  devops:
    password: "DevOps123"
    uid: 1002
    gid: 1002
    home: "/home/devops"
    shell: "/bin/bash"
    gecos: "DevOps Engineer"
  
  sysadmin:
    password: "SysAdmin2024!"
    uid: 1003
    gid: 1003
    home: "/home/sysadmin"
    shell: "/bin/bash"
    gecos: "System Administrator"

filesystem:
  proc: {}
  sys: {}
  dev: {}
  run: {}
  tmp: {}
  
  usr:
    bin: {}
    sbin: {}
    local:
      bin: {}
      share: {}
  
  etc:
    apache2:
      sites-available: {}
      sites-enabled: {}
    nginx:
      sites-available: {}
      sites-enabled: {}
    mysql: {}
    ssl:
      certs: {}
      private: {}
  
  var:
    www:
      html: {}
      apps:
        production: {}
        staging: {}
    log:
      apache2: {}
      nginx: {}
      application: {}
    data:
      uploads: {}
      backups: {}
      cache: {}
  
  opt:
    applications:
      config: {}
      scripts: {}
    scripts:
      backup: {}
      monitoring: {}
  
  home:
    webadmin:
      .ssh: {}
    devops:
      .ssh: {}
    sysadmin:
      .ssh: {}
  
  root:
    .ssh: {}
  
  srv:
    applications: {}
    data: {}

files:
  /etc/hostname:
    content: "app-server-prd01.corporate.local"
  
  /etc/motd:
    content: |
      ================================================================================
                            CORPORATE IT SYSTEMS
                          PRODUCTION ENVIRONMENT
      ================================================================================
      
      Authorized access only. Unauthorized access prohibited.
      
      System: Application Server
      Environment: PRODUCTION
      Maintenance Window: Weekends 02:00-04:00 EST
      
      Contact IT Support: helpdesk@corporate.local
      Emergency Hotline: x5911
      
      ================================================================================
  
  /var/www/html/index.html:
    content: |
      <!DOCTYPE html>
      <html>
      <head>
          <title>Corporate Portal</title>
          <meta charset="UTF-8">
      </head>
      <body>
          <h1>Welcome to Corporate Portal</h1>
          <p>Internal applications and resources</p>
          <ul>
              <li><a href="/apps/hr">HR Portal</a></li>
              <li><a href="/apps/finance">Finance System</a></li>
              <li><a href="/apps/crm">CRM Dashboard</a></li>
          </ul>
      </body>
      </html>
  
  /etc/apache2/sites-available/000-default.conf:
    content: |
      <VirtualHost *:80>
          ServerAdmin webmaster@corporate.local
          ServerName app-server-prd01.corporate.local
          DocumentRoot /var/www/html
          
          <Directory /var/www/html>
              Options Indexes FollowSymLinks
              AllowOverride All
              Require all granted
          </Directory>
          
          ErrorLog ${APACHE_LOG_DIR}/error.log
          CustomLog ${APACHE_LOG_DIR}/access.log combined
      </VirtualHost>
  
  /var/log/apache2/access.log:
    content: |
      192.168.1.45 - - [13/Oct/2024:09:15:23 -0400] "GET / HTTP/1.1" 200 1234
      192.168.1.56 - - [13/Oct/2024:09:16:45 -0400] "GET /apps/hr HTTP/1.1" 200 5678
      192.168.1.78 - - [13/Oct/2024:09:17:12 -0400] "POST /api/login HTTP/1.1" 200 234
      192.168.1.89 - - [13/Oct/2024:09:18:33 -0400] "GET /apps/finance HTTP/1.1" 200 3456
  
  /var/log/application/app.log:
    content: |
      2024-10-13 09:15:23 [INFO] Application started successfully
      2024-10-13 09:16:45 [INFO] User 'jdoe' logged in from 192.168.1.45
      2024-10-13 09:17:12 [INFO] Database connection established
      2024-10-13 09:18:33 [WARN] High memory usage detected - 78%
      2024-10-13 09:19:55 [INFO] Cache cleared - 256MB freed
  
  /opt/applications/config/app.conf:
    content: |
      # Application Configuration
      [application]
      name=CorporatePortal
      version=2.5.1
      environment=production
      
      [database]
      host=db-prd-01.corporate.local
      port=3306
      database=corporate_db
      connection_pool=50
      
      [security]
      session_timeout=1800
      password_min_length=12
      enable_2fa=true
      
      [logging]
      level=INFO
      max_file_size=100MB
      retention_days=30
  
  /opt/scripts/backup/daily_backup.sh:
    content: |
      #!/bin/bash
      # Daily backup script
      
      BACKUP_DIR="/var/data/backups"
      DATE=$(date +%Y%m%d)
      
      echo "Starting backup at $(date)"
      
      # Backup database
      mysqldump -h db-prd-01 -u backup corporate_db > $BACKUP_DIR/db_$DATE.sql
      
      # Backup application files
      tar -czf $BACKUP_DIR/app_$DATE.tar.gz /var/www/apps/
      
      echo "Backup completed at $(date)"

custom_commands:
  app-status:
    path: "/usr/local/bin/app-status"
    content: |
      #!/bin/bash
      cat << 'EOL'
      Application Server Status
      Generated: October 13, 2024 09:45:00 EST
      Server: app-server-prd01.corporate.local
      
      === WEB SERVICES ===
      Apache Web Server     : RUNNING (PID: 1234)
      Nginx Reverse Proxy   : RUNNING (PID: 1235)
      Application Service   : RUNNING (PID: 1236)
      
      === APPLICATION STATUS ===
      Corporate Portal      : ONLINE
      HR Portal            : ONLINE
      Finance System       : ONLINE
      CRM Dashboard        : ONLINE
      
      === DATABASE ===
      MySQL Connection     : ACTIVE
      Connection Pool      : 45/50 used
      Query Response Time  : 15ms avg
      
      === SYSTEM RESOURCES ===
      CPU Usage            : 58%
      Memory Usage         : 72% (14.4GB/20GB)
      Disk Usage           : /var 45% full
      Active Connections   : 234
      
      === RECENT ACTIVITY ===
      Active Users         : 156
      Page Views (1hr)     : 4,567
      API Requests (1hr)   : 12,345
      
      === BACKUPS ===
      Last Backup          : 2024-10-13 02:00:00
      Backup Status        : SUCCESS
      Backup Size          : 2.3GB
      EOL
  
  check-logs:
    path: "/usr/local/bin/check-logs"
    content: |
      #!/bin/bash
      echo "Recent Application Logs"
      echo "======================="
      echo ""
      tail -20 /var/log/application/app.log
      echo ""
      echo "Recent Web Access"
      echo "================="
      echo ""
      tail -10 /var/log/apache2/access.log
